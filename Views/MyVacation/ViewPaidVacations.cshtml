@{
    ViewData["Title"] = "My Paid Vacations";

    var hotels = ViewBag.Hotels;
    var cars = ViewBag.Cars;
    var attractions = ViewBag.Attractions;
    var flights = ViewBag.Flights;
}

<div class="container mt-5 mb-5">
    <h2 class="text-center mb-4">My Paid Vacations</h2>

    @if (!string.IsNullOrEmpty(ViewBag.Message))
    {
        <div class="alert alert-info text-center">@ViewBag.Message</div>
    }

    <div class="text-center mb-4">
        <a asp-controller="Account" asp-action="ViewAccount" class="btn btn-secondary">View Account</a>
    </div>

    <!-- HOTEL BOOKINGS -->
    <h4 class="mt-5">Paid Hotel Bookings</h4>
    @if (hotels is System.Data.DataTable hotelTable && hotelTable.Rows.Count > 0)
    {
        <table class="table table-striped table-bordered text-center mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Hotel</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Total Price</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow h in hotelTable.Rows)
                {
                    <tr>
                        <td>@h["HotelName"]</td>
                        <td>@h["RoomName"]</td>
                        <td>@Convert.ToDateTime(h["CheckInDate"]).ToString("MM/dd/yyyy")</td>
                        <td>@Convert.ToDateTime(h["CheckOutDate"]).ToString("MM/dd/yyyy")</td>
                        <td>@Convert.ToDecimal(h["TotalAmount"]).ToString("C")</td>
                        <td>@h["PaymentStatus"]</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p class="text-muted">No paid hotel bookings.</p>
    }

    <!-- CAR BOOKINGS -->
    <h4 class="mt-5">Paid Car Bookings</h4>
    @if (cars is System.Data.DataTable carTable && carTable.Rows.Count > 0)
    {
        <table class="table table-striped table-bordered text-center mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Car</th>
                    <th>Total Cost</th>
                    <th>Status</th>
                    <th>Booked On</th>
                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow c in carTable.Rows)
                {
                    <tr>
                        <td>@c["CarName"]</td>
                        <td>@Convert.ToDecimal(c["TotalAmount"]).ToString("C")</td>
                        <td>@c["PaymentStatus"]</td>
                        <td>@Convert.ToDateTime(c["BookedOn"]).ToString("MM/dd/yyyy")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p class="text-muted">No paid car bookings.</p>
    }

    <!-- FLIGHT BOOKINGS -->
    <h4 class="mt-5">Paid Flight Bookings</h4>
    @if (flights is System.Data.DataTable flightTable && flightTable.Rows.Count > 0)
    {
        <table class="table table-striped table-bordered text-center mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Flight</th>
                    <th>Seats</th>
                    <th>Seat Count</th>
                    <th>Total Amount</th>
                    <th>Status</th>
                    <th>Booked On</th>
                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow f in flightTable.Rows)
                {
                    <tr>
                        <td>@f["FlightID"]</td>
                        <td>@f["Seats"]</td>
                        <td>@f["SeatCount"]</td>
                        <td>@String.Format("{0:C}", f["TotalAmount"])</td>
                        <td>@f["PaymentStatus"]</td>
                        <td>@Convert.ToDateTime(f["BookedOn"]).ToString("MM/dd/yyyy")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p class="text-muted">No paid flight bookings.</p>
    }

    <!-- ATTRACTION BOOKINGS -->
    <h4 class="mt-5">Attraction Bookings</h4>
    @if (attractions is System.Data.DataTable attractionTable && attractionTable.Rows.Count > 0)
    {
        <table class="table table-striped table-bordered text-center mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Event Name</th>
                    <th>Price</th>
                    <th>Tickets</th>
                    <th>Total Amount</th>
                    <th>Status</th>
                    <th>Booked On</th>
                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow a in attractionTable.Rows)
                {
                    <tr>
                        <td>@a["EventName"]</td>
                        <td>@Convert.ToDecimal(a["EventPrice"]).ToString("C")</td>
                        <td>@Convert.ToInt32(a["NumberOfTickets"])</td>
                        <td>@Convert.ToDecimal(a["TotalAmount"]).ToString("C")</td>
                        <td>@a["PaymentStatus"]</td>
                        <td>@Convert.ToDateTime(a["BookedOn"]).ToString("MM/dd/yyyy")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p class="text-muted">No attraction bookings.</p>
    }
    <!-- ZILLOW RENTALS -->
    <h4 class="mt-5">Paid Zillow Rentals</h4>

    @if (ViewBag.ZillowRentals is System.Data.DataTable zrTable && zrTable.Rows.Count > 0)
    {
        <table class="table table-striped table-bordered text-center mt-3">
            <thead class="table-dark">
                <tr>
                    <th>Address</th>
                    <th>City</th>
                    <th>State</th>
                    <th>Daily Rate</th>
                    <th>Days</th>
                    <th>Total Amount</th>
                    <th>Status</th>
                    <th>Booked On</th>
                </tr>
            </thead>
            <tbody>
                @foreach (System.Data.DataRow r in zrTable.Rows)
                {
                    <tr>
                        <td>@r["Address"]</td>
                        <td>@r["City"]</td>
                        <td>@r["State"]</td>
                        <td>@Convert.ToDecimal(r["DailyRate"]).ToString("C")</td>
                        <td>@Convert.ToInt32(r["Days"])</td>
                        <td>@Convert.ToDecimal(r["TotalAmount"]).ToString("C")</td>
                        <td>@r["PaymentStatus"]</td>
                        <td>@Convert.ToDateTime(r["BookedOn"]).ToString("MM/dd/yyyy")</td>
                    </tr>
                }
            </tbody>
        </table>
    }
    else
    {
        <p class="text-muted">No paid Zillow rentals.</p>
    }


    <hr class="my-5" />

    <div class="text-center">
        @if (ViewBag.HasPaid == false)
        {
            <p class="text-success fw-bold mb-3">You have no paid bookings. Create a new vacation now!</p>
            <a asp-controller="Hotels" asp-action="SearchHotels" class="btn btn-primary">Start New Vacation</a>
        }
    </div>
</div>